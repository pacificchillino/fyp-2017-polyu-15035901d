<%- include('header'); %>

	<%# Search Box --------------------------------------------------------------------- %>

	<%
	function section(compare){
		if (typeof params === "undefined"){
			return "";
		}else{
			return (params.stopA+"/"+params.stopB == compare) ? " selected" : "";
		}
	}
	%>
	<div class="panel panel-default">
		<div class="panel-heading"><b><%= title %></b></div>
		<div class="panel-body">
			<form>
				<div class="form-group">
					<div class="row">
						<%# Section %>
						<label class="control-label col-sm-3 col-lg-4" for="section">Select section:</label>
						<div class="col-sm-9 col-lg-8">
							<select class="form-control" id="section">
								<option value="">-- Please select --</option>
								<% for (var i in searchbox.sections){ %>
								<option value = "<%= searchbox.sections[i].from_to %>"<%= section(searchbox.sections[i].from_to) %>><%= searchbox.sections[i].caption %></option>
								<% } %>
							</select>
						</div>
						<div class="col-sm-12 col-lg-12" style="padding-top: 0.5em; padding-bottom: 0.5em;">
							For the following input factors, keep blank if the current factors are used.
						</div>
						<%# D.O.W. %>
						<label class="control-label col-sm-3 col-lg-2" for="dow">Day of Week:</label>
						<div class="col-sm-9 col-lg-4">
							<select class="form-control" id="dow" onchange="dow_changed();">
								<option value="">[Today]</option>
								<option value = "0">Sunday</option>
								<option value = "1">Monday</option>
								<option value = "2">Tuesday</option>
								<option value = "3">Wednesday</option>
								<option value = "4">Thursday</option>
								<option value = "5">Friday</option>
								<option value = "6">Saturday</option>
							</select>
						</div>
						<%# P.H. %>
						<label class="control-label col-sm-3 col-lg-2" for="ph">Public Holiday?</label>
						<div class="col-sm-9 col-lg-4">
							<select class="form-control" id="ph" onchange="dow_changed();">
								<option value="">[Today]</option>
								<option value = "1">Yes</option>
								<option value = "0">No</option>
							</select>
						</div>
						<%# Filter: Hours %>
						<label class="control-label col-sm-3 col-lg-2" for="time">Time:</label>
						<div class="col-sm-9 col-lg-4">
								<input type="text" class="form-control" id="time" placeholder="(in hours or 'hh:mm:ss')">
						</div>
						<%# Filter: Rainfall %>
						<label class="control-label col-sm-3 col-lg-2" for="rainfall">Rainfall (mm):</label>
						<div class="col-sm-9 col-lg-4">
								<input type="text" class="form-control" id="rainfall">
						</div>
						<%# Filter: HKO Temp %>
						<label class="control-label col-sm-3 col-lg-2" for="HKO_temp">HKO Temperature (â„ƒ):</label>
						<div class="col-sm-9 col-lg-4">
								<input type="text" class="form-control" id="HKO_temp">
						</div>
						<%# Filter: HKO Humidity %>
						<label class="control-label col-sm-3 col-lg-2" for="HKO_hum">HKO Humidity (%):</label>
						<div class="col-sm-9 col-lg-4">
								<input type="text" class="form-control" id="HKO_hum">
						</div>
					</div>
					<div class="row">
						<br/>
						<button type="button" class="btn-block btn-default" onclick="searchbox_submit();">Predict</button>
					</div>
				</div>
			</form>
		</div>
	</div>

	<script language = "javascript">
		//DOW Changed (Sunday must be public holiday)
		function dow_changed(){
			if ($("#dow").val() == "0"){
				$("#ph").val("1");
			}
		}

		//Submit
		function searchbox_submit(){
			if ($("#section").val() != ""){
				//Valid
				var URL = "/trams/predict_sect/" + $("#section").val();
				//Input Factors
				var params = [];
				if ($("#dow").val() != "") params.push("dow=" + encodeURI($("#dow").val()));
				if ($("#ph").val() != "") params.push("ph=" + encodeURI($("#ph").val()));
				if ($("#time").val() != "") params.push("time=" + encodeURI($("#time").val()));
				if ($("#rainfall").val() != "") params.push("rainfall=" + encodeURI($("#rainfall").val()));
				if ($("#HKO_temp").val() != "") params.push("hkotemp=" + encodeURI($("#HKO_temp").val()));
				if ($("#HKO_hum").val() != "") params.push("hkohum=" + encodeURI($("#HKO_hum").val()));
				//Appand to URL
				if (params.length){
					URL += "?" + params.join("&");
				}
				//Go to new URL
				window.location.href = URL;
			}
		}
	</script>
	
	<%# Search Box Ends --------------------------------------------------------------------- %>

<%- include('footer'); %>